A system for modeling exotic equity derivatives at Barcap, developed in Haskell, initially as an embedded DSL. Simon Frankau [wrote](http://arbitrary.name/papers/fpf.pdf) about the early incarnation. In 2012 Peter Marks, the manager of the team responsible for this system, mentioned that it turned out the modelers don't think in terms of mathematical functions, but more in terms of imperative steps and conditions. The system has thus evolved to be a proper DSL with a compiler that generates C code. Peter said it's still pure in nature, but the code exists in a [Writer monad](), so it reads imperatively.
